window.onload= function(){
  let progressList = {
  "00hJv4mzvqM3D9kBy3dfxoJyFV82": {
      "intro": {
          "totalDuration": 465,
          "units": {
              "01-introduction": {
                  "percent": 100,
                  "parts": {
                      "02-why-learn-to-code": {
                          "duration": 20,
                          "completed": 1,
                          "type": "read",
                          "completedAt": "2018-03-29T05:11:05.809Z"
                      },
                      "01-growth-mindset": {
                          "type": "read",
                          "completedAt": "2018-03-29T05:08:45.105Z",
                          "duration": 20,
                          "completed": 1
                      },
                      "00-welcome-and-orientation": {
                          "type": "read",
                          "completedAt": "2018-03-29T04:58:42.156Z",
                          "duration": 10,
                          "completed": 1
                      },
                      "04-quiz": {
                          "score": 40,
                          "type": "quiz",
                          "completedAt": "2018-03-30T03:52:12.632Z",
                          "duration": 20,
                          "completed": 1
                      },
                      "03-your-first-website": {
                          "type": "read",
                          "completedAt": "2018-03-29T05:21:08.998Z",
                          "duration": 20,
                          "completed": 1
                      }
                  },
                  "totalParts": 5,
                  "completedParts": 5,
                  "totalDuration": 90,
                  "completedDuration": 90
              },
              "03-ux-design": {
                  "totalParts": 4,
                  "completedParts": 0,
                  "totalDuration": 90,
                  "completedDuration": 0,
                  "percent": 0,
                  "parts": {
                      "00-development-team": {
                          "duration": 15,
                          "completed": 0,
                          "type": "read"
                      },
                      "02-ux-design-vs-ui-design": {
                          "duration": 30,
                          "completed": 0,
                          "type": "read"
                      },
                      "01-ux-design": {
                          "duration": 15,
                          "completed": 0,
                          "type": "read"
                      },
                      "03-quiz": {
                          "duration": 30,
                          "completed": 0,
                          "type": "quiz"
                      }
                  }
              },
              "02-variables-and-data-types": {
                  "parts": {
                      "03-comments": {
                          "duration": 15,
                          "completed": 1,
                          "type": "read",
                          "completedAt": "2018-03-30T04:08:51.540Z"
                      },
                      "06-exercises": {
                          "exercises": {
                              "01-coin-convert": {
                                  "completed": 0
                              },
                              "02-restaurant-bill": {
                                  "completed": 0
                              }
                          },
                          "type": "practice",
                          "duration": 30,
                          "completed": 0
                      },
                      "00-values-data-types-and-operators": {
                          "duration": 60,
                          "completed": 0,
                          "type": "read"
                      },
                      "05-quiz": {
                          "score": 17,
                          "type": "quiz",
                          "completedAt": "2018-04-05T17:16:57.303Z",
                          "duration": 30,
                          "completed": 1
                      },
                      "04-guided-exercises": {
                          "duration": 60,
                          "completed": 1,
                          "type": "practice",
                          "completedAt": "2018-04-05T17:13:22.380Z"
                      },
                      "01-variables": {
                          "type": "read",
                          "duration": 60,
                          "completed": 0
                      },
                      "02-self-learning-MDN": {
                          "type": "read",
                          "completedAt": "2018-03-30T04:17:59.539Z",
                          "duration": 30,
                          "completed": 1
                      }
                  },
                  "totalParts": 7,
                  "completedParts": 4,
                  "totalDuration": 285,
                  "completedDuration": 135,
                  "percent": 58
              }
          },
          "completedUnits": 1.58,
          "completedDuration": 225,
          "totalUnits": 3,
          "percent": 53
      }
  },
  "04oXrfTxNUbhGtkxNTfw7fhHVgs1": {
      "intro": {
          "totalDuration": 465,
          "units": {
              "03-ux-design": {
                  "parts": {
                      "03-quiz": {
                          "score": 88,
                          "type": "quiz",
                          "completedAt": "2018-03-23T05:53:09.391Z",
                          "duration": 30,
                          "completed": 1
                      },
                      "00-development-team": {
                          "duration": 15,
                          "completed": 1,
                          "type": "read",
                          "completedAt": "2018-03-19T07:28:17.194Z"
                      },
                      "02-ux-design-vs-ui-design": {
                          "type": "read",
                          "completedAt": "2018-03-23T05:35:32.837Z",
                          "duration": 30,
                          "completed": 1
                      },
                      "01-ux-design": {
                          "duration": 15,
                          "completed": 1,
                          "type": "read",
                          "completedAt": "2018-03-23T04:30:57.044Z"
                      }
                  },
                  "totalParts": 4,
                  "completedParts": 4,
                  "totalDuration": 90,
                  "completedDuration": 90,
                  "percent": 100
              },
              "02-variables-and-data-types": {
                  "parts": {
                      "01-variables": {
                          "duration": 60,
                          "completed": 1,
                          "type": "read",
                          "completedAt": "2018-03-19T03:39:20.142Z"
                      },
                      "02-self-learning-MDN": {
                          "type": "read",
                          "completedAt": "2018-03-19T04:05:48.060Z",
                          "duration": 30,
                          "completed": 1
                      },
                      "03-comments": {
                          "duration": 15,
                          "completed": 1,
                          "type": "read",
                          "completedAt": "2018-03-19T04:51:01.964Z"
                      },
                      "06-exercises": {
                          "duration": 30,
                          "completed": 1,
                          "exercises": {
                              "01-coin-convert": {
                                  "completed": 1,
                                  "completedAt": "2018-03-19T07:10:32.696Z"
                              },
                              "02-restaurant-bill": {
                                  "completedAt": "2018-03-19T07:18:51.455Z",
                                  "completed": 1
                              }
                          },
                          "type": "practice",
                          "completedAt": "2018-03-19T07:18:51.455Z"
                      },
                      "00-values-data-types-and-operators": {
                          "duration": 60,
                          "completed": 1,
                          "type": "read",
                          "completedAt": "2018-03-19T00:19:55.182Z"
                      },
                      "05-quiz": {
                          "duration": 30,
                          "completed": 1,
                          "score": 92,
                          "type": "quiz",
                          "completedAt": "2018-03-19T06:55:14.568Z"
                      },
                      "04-guided-exercises": {
                          "type": "practice",
                          "completedAt": "2018-03-19T05:18:02.961Z",
                          "duration": 60,
                          "completed": 1
                      }
                  },
                  "totalParts": 7,
                  "completedParts": 7,
                  "totalDuration": 285,
                  "completedDuration": 285,
                  "percent": 100
              },
              "01-introduction": {
                  "totalDuration": 90,
                  "completedDuration": 90,
                  "percent": 100,
                  "parts": {
                      "00-welcome-and-orientation": {
                          "type": "read",
                          "completedAt": "2018-03-18T17:02:57.677Z",
                          "duration": 10,
                          "completed": 1
                      },
                      "04-quiz": {
                          "duration": 20,
                          "completed": 1,
                          "score": 100,
                          "type": "quiz",
                          "completedAt": "2018-03-18T21:40:38.851Z"
                      },
                      "03-your-first-website": {
                          "type": "read",
                          "completedAt": "2018-03-18T20:00:34.104Z",
                          "duration": 20,
                          "completed": 1
                      },
                      "02-why-learn-to-code": {
                          "type": "read",
                          "completedAt": "2018-03-18T19:50:10.406Z",
                          "duration": 20,
                          "completed": 1
                      },
                      "01-growth-mindset": {
                          "duration": 20,
                          "completed": 1,
                          "type": "read",
                          "completedAt": "2018-03-18T18:42:06.789Z"
                      }
                  },
                  "totalParts": 5,
                  "completedParts": 5
              }
          },
          "completedUnits": 3,
          "completedDuration": 465,
          "totalUnits": 3,
          "percent": 100
      }
  },
  "07HI1lPZ4XdOhdQkyzBv3CaVMYq2": {
      "intro": {
          "totalDuration": 465,
          "units": {
              "01-introduction": {
                  "parts": {
                      "02-why-learn-to-code": {
                          "type": "read",
                          "completedAt": "2018-03-27T17:57:20.412Z",
                          "duration": 20,
                          "completed": 1
                      },
                      "01-growth-mindset": {
                          "duration": 20,
                          "completed": 1,
                          "type": "read",
                          "completedAt": "2018-03-27T17:44:16.288Z"
                      },
                      "00-welcome-and-orientation": {
                          "duration": 10,
                          "completed": 1,
                          "type": "read",
                          "completedAt": "2018-03-27T17:23:24.835Z"
                      },
                      "04-quiz": {
                          "score": 60,
                          "type": "quiz",
                          "completedAt": "2018-03-27T20:05:15.418Z",
                          "duration": 20,
                          "completed": 1
                      },
                      "03-your-first-website": {
                          "type": "read",
                          "completedAt": "2018-03-27T18:19:59.944Z",
                          "duration": 20,
                          "completed": 1
                      }
                  },
                  "totalParts": 5,
                  "completedParts": 5,
                  "totalDuration": 90,
                  "completedDuration": 90,
                  "percent": 100
              },
              "03-ux-design": {
                  "totalDuration": 90,
                  "completedDuration": 90,
                  "percent": 100,
                  "parts": {
                      "00-development-team": {
                          "duration": 15,
                          "completed": 1,
                          "type": "read",
                          "completedAt": "2018-03-28T17:14:06.384Z"
                      },
                      "02-ux-design-vs-ui-design": {
                          "type": "read",
                          "completedAt": "2018-03-28T17:21:30.510Z",
                          "duration": 30,
                          "completed": 1
                      },
                      "01-ux-design": {
                          "duration": 15,
                          "completed": 1,
                          "type": "read",
                          "completedAt": "2018-03-28T17:13:48.349Z"
                      },
                      "03-quiz": {
                          "duration": 30,
                          "completed": 1,
                          "score": 75,
                          "type": "quiz",
                          "completedAt": "2018-03-28T18:15:25.443Z"
                      }
                  },
                  "totalParts": 4,
                  "completedParts": 4
              },
              "02-variables-and-data-types": {
                  "completedDuration": 285,
                  "percent": 100,
                  "parts": {
                      "00-values-data-types-and-operators": {
                          "type": "read",
                          "completedAt": "2018-03-29T05:54:23.128Z",
                          "duration": 60,
                          "completed": 1
                      },
                      "05-quiz": {
                          "score": 55,
                          "type": "quiz",
                          "completedAt": "2018-04-01T23:29:00.937Z",
                          "duration": 30,
                          "completed": 1
                      },
                      "04-guided-exercises": {
                          "type": "practice",
                          "completedAt": "2018-03-31T18:28:07.095Z",
                          "duration": 60,
                          "completed": 1
                      },
                      "01-variables": {
                          "duration": 60,
                          "completed": 1,
                          "type": "read",
                          "completedAt": "2018-03-29T22:43:32.021Z"
                      },
                      "02-self-learning-MDN": {
                          "type": "read",
                          "completedAt": "2018-04-01T20:51:50.121Z",
                          "duration": 30,
                          "completed": 1
                      },
                      "03-comments": {
                          "type": "read",
                          "completedAt": "2018-04-01T17:12:09.213Z",
                          "duration": 15,
                          "completed": 1
                      },
                      "06-exercises": {
                          "type": "practice",
                          "completedAt": "2018-04-02T20:56:51.416Z",
                          "duration": 30,
                          "completed": 1,
                          "exercises": {
                              "01-coin-convert": {
                                  "completed": 1,
                                  "completedAt": "2018-04-02T20:56:51.416Z"
                              },
                              "02-restaurant-bill": {
                                  "completedAt": "2018-04-02T20:40:20.999Z",
                                  "completed": 1
                              }
                          }
                      }
                  },
                  "totalParts": 7,
                  "completedParts": 7,
                  "totalDuration": 285
              }
          },
          "completedUnits": 3,
          "completedDuration": 465,
          "totalUnits": 3,
          "percent": 100
      }
    }
  }

  let usersList = [
    {
      "id": "00hJv4mzvqM3D9kBy3dfxoJyFV82",
      "signupCohort": "lim-2018-03-pre-core-pw",
      "timezone": "America/Lima",
      "name": "Lizeth",
      "locale": "es-ES",
      "role": "student"
    },
    {
      "id": "04oXrfTxNUbhGtkxNTfw7fhHVgs1",
      "name": "Devora Alexandra Miñano Vejarano",
      "locale": "es-PE",
      "signupCohort": "lim-2018-03-pre-core-pw",
      "timezone": "America/Lima",
      "role": "student"
    },
    {
      "id": "07HI1lPZ4XdOhdQkyzBv3CaVMYq2",
      "timezone": "America/Lima",
      "name": "monica jimena",
      "locale": "es-PE",
      "signupCohort": "lim-2018-03-pre-core-pw",
      "role": "student"
    }
  ];

  let studentsArray =
  [
    {
      'name': 'juana',
      'stats': {
        'percent': 30,
        'exercises': {
          'completed': 1
        }
      }
    },
    {
      'name': 'ana',
      'stats': {
        'percent': 50,
        'exercises': {
          'completed': 2
        }
      }
    },
    {
      'name': 'diana',
      'stats': {
        'percent': 28,
        'exercises': {
          'completed': 20
        }
      }
    },
    {
      'name': 'liliana',
      'stats': {
        'percent': 50,
        'exercises': {
          'completed': 18
        }
      }
    }
  ];

  const selectCohort = document.getElementById('cohortSelector');

  let sampleCohort = 'lim-2018-03-pre-core-pw';
  let cohorts = [];
  fetchCohorts();
  let users = fetchUsersFromAPI(sampleCohort);
  let progress = fetchProgressFromAPI(sampleCohort);
  let courses = getCoursesIndexInCohort(cohorts, sampleCohort);

  console.log(users.length);
  console.log(progress.length);
  console.log(courses.length);

  function fetchCohorts () {
    fetch('https://api.laboratoria.la/cohorts')
      .then((res) => res.json())
      .then((data) => {
        for (let i = 0; i < data.length; i++) {
          let option = document.createElement("option");
          option.text = data[i].id;
          selectCohort.add(option);
        }
      });
  }

  function getCoursesIndexInCohort(cohorts, cohortId) {
    for (var i = 0; i < cohorts.length; i++) {
      if (cohorts[i].id === cohortId){
        return cohorts[i].coursesIndex;
      }
    }
  }

  function fetchUsersFromStaticData(cohort) {
    let parsedObject = JSON.parse(users);
    return parsedObject;
  }

  function fetchUsersFromAPI(cohort) {
    let fetchedUsers = [];
    fetch('https://laboratoria-la-staging.firebaseapp.com/cohorts/'+cohort+'/users')
      .then((res) => res.json())
      .then((data) => {
        for (let i = 0; i < data.length; i++) {
          fetchedUsers.push(data[i]);
        }
      });
      return fetchedUsers;
  }

  function fetchProgressFromAPI(cohort) {
    let fetchedProgress = [];
    fetch('https://laboratoria-la-staging.firebaseapp.com/cohorts/'+cohort+'/progress')
      .then((res) => res.json())
      .then((data) => {
        for (let i = 0; i < data.length; i++) {
          fetchedProgress.push(data[i]);
        }
      });
      return fetchedProgress;
  }

  let table = document.getElementById("userTable");
  for (var i = 1; i < studentsArray.length; i++) {
    let row = table.insertRow(i);
    var cellName = row.insertCell(0);
    var cellPercent = row.insertCell(1);
    var cellExcercisesCompleted = row.insertCell(2);
    cellName.innerHTML = studentsArray[i].name;
    cellPercent.innerHTML = studentsArray[i].stats.percent;
    cellExcercisesCompleted.innerHTML = studentsArray[i].stats.exercises.completed;

  }
}
